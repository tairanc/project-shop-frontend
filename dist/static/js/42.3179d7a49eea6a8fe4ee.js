webpackJsonp([42],{Pclv:function(t,e){},ruoC:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("4YfN"),a=o.n(s),r=o("2bvH"),i=o("1G+u"),l=o("VXZc"),n=o("qsHl"),c=o("NcNL"),m=o.n(c),f=o("wJ7o"),_=o.n(f),d=/^\d+(\.{0,1}\d+){0,1}$/,u={data:function(){var t=this;return{delivery:{form:{freight_template_id:""},dialogVisible:!1},category:{form:{category_id:[]},dialogVisible:!1},formOnStock:{name:"formOnStock",loading:!1,total:0,form:{title:"",art_no:"",shop_category_id:"",shop_category_list:[],supply_bind_status:"",min_price:"",max_price:"",logistics_template_id:"",bar_code:"",status:10,page:1,page_size:20},rules:{title:[{max:60,message:"长度在 0 到 60 个字符",trigger:"blur"}],art_no:[{max:50,message:"长度在 0 到 50 个字符",trigger:"blur"}],min_price:[{validator:function(e,o,s){o?d.test(o)?(t.$refs.formOnStock.validateField("max_price"),s()):s(new Error("最低价必须为数字")):s()},trigger:"blur"}],max_price:[{validator:function(e,o,s){o||0===o?d.test(o)?o<parseFloat(t.formOnStock.form.min_price)?s(new Error("最高价不得小于最低价")):s():s(new Error("最高价必须为数字")):s()},trigger:"blur"}]},columns:[{label:"商品名称",desField:"1"},{label:"店铺分类",field:"shop_category_name",align:"center"},{label:"价格（元）",field:"sell_price",align:"center"},{label:"总库存",field:"total_store",align:"center"},{label:"运费模板",field:"logistics_template_name",align:"center"},{label:"供应链绑定",field:"supply_bind_status",align:"center"},{label:"发布时间",field:"updated_at",align:"center"},{label:"下架原因",field:"stocked_comment",align:"center"},{label:"操作",field:"options",link:"/goods-manage/goods/edit",align:"center"}],columns_enter:[{label:"商品名称",desField:"1"},{label:"店铺分类",field:"shop_category_name",align:"center"},{label:"价格（元）",field:"sell_price",align:"center"},{label:"总库存",field:"total_store",align:"center"},{label:"运费模板",field:"logistics_template_name",align:"center"},{label:"供应链绑定",field:"supply_bind_status",align:"center"},{label:"发布时间",field:"updated_at",align:"center"},{label:"下架原因",field:"stocked_comment",align:"center"},{label:"未通过原因",field:"audit_comment",align:"center"},{label:"操作",field:"options",link:"/goods-manage/goods/edit",align:"center"}],list:[],selectList:[]},exportList:[],biz_mode:1}},computed:a()({},Object(r.c)(["deliveryTplUpList","categoryList"])),methods:{exportGoodTable:function(){var t=this;n.a.exportGoods(this.formOnStock.form).then(function(e){e.data.map(function(t){switch(t.trade_type){case 10:t.trade_type="一般贸易";break;case 20:t.trade_type="海淘";break;case 30:t.trade_type="跨境保税";break;case 40:t.trade_type="海外直邮"}switch(!t.tax_rate&&(t.tax_rate=""),t.status="仓库中",t.free_refund){case 0:t.free_refund="否";break;case 1:t.free_refund="是"}}),t.exportList=e.data,setTimeout(function(){var t=_.a.utils.table_to_book(document.querySelector("#export-form"));for(var e in t.Sheets.Sheet1)t.Sheets.Sheet1[e].t&&("("==String(t.Sheets.Sheet1[e].v).substr(0,1)&&""!=t.Sheets.Sheet1[e]&&(t.Sheets.Sheet1[e].v=String(t.Sheets.Sheet1[e].v).substr(1,t.Sheets.Sheet1[e].v.length-1)),t.Sheets.Sheet1[e].t="s");var o=_.a.write(t,{bookType:"xlsx",bookSST:!1,type:"binary"});try{m.a.saveAs(new Blob([function(t){for(var e=new ArrayBuffer(t.length),o=new Uint8Array(e),s=0;s!==t.length;++s)o[s]=255&t.charCodeAt(s);return e}(o)],{type:"application/octet-stream"}),"商品列表.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,o)}return o},1e3),t.$message({showClose:!0,message:"导出成功",type:"success"})})},getCategoryId:function(t){this.formOnStock.form.shop_category_id=t[t.length-1]},handleSelectChange:function(t){var e=this;e.formOnStock.selectList=[],t.forEach(function(t){e.formOnStock.selectList.push(t.id)})},handleSizeChange:function(t){this.formOnStock.form.page_size=t,this.getItemList(this.formOnStock.form)},handleNumberChange:function(t){this.formOnStock.form.page=t,this.getItemList(this.formOnStock.form)},search:function(){var t=this;this.$refs.formOnStock.validate(function(e){e&&(t.formOnStock.loading=!0,t.formOnStock.form.page=1,t.getItemList(t.formOnStock.form))})},resetForm:function(){this.$refs.formOnStock.resetFields(),this.formOnStock.form.shop_category_list=[]},deleteBtn:function(){var t=this,e={item_ids:this.formOnStock.selectList};this.$confirm("此操作将删除已选择的全部商品, 是否确定?","提示",{closeOnClickModal:!1,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteItemList(e)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},setShelfBtn:function(t){var e=this,o={item_ids:this.formOnStock.selectList,shelf_status:30};this.$confirm("此操作将上架已选择的全部商品, 是否确定?","提示",{closeOnClickModal:!1,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.setShelf(o)}).catch(function(){e.$message({type:"info",message:"已取消上架"})})},setTemplateBtn:function(){var t={item_ids:this.formOnStock.selectList,freight_template_id:this.delivery.form.freight_template_id};this.setTemplate(t)},setCategoryBtn:function(){var t=this.category.form.category_id.length,e={item_ids:this.formOnStock.selectList,category_id:this.category.form.category_id[t-1]};this.setShopCategory(e)},showTemplate:function(){this.delivery.form.freight_template_id="",this.delivery.dialogVisible=!0},cancelTempDialog:function(){this.delivery.dialogVisible=!1,this.$message({type:"info",message:"已取消操作"})},showCategory:function(){this.category.form.category_id=[],this.category.dialogVisible=!0},cancelCategoryDialog:function(){this.category.dialogVisible=!1,this.$message({type:"info",message:"已取消操作"})},getItemList:function(t){var e=this;n.a.getItemList(t).then(function(t){for(var o in e.biz_mode=t.data.biz_mode,e.formOnStock.list=[],e.formOnStock.loading=!1,e.formOnStock.total=t.data.total_count,t.data.list){switch(t.data.list[o].supply_bind_status){case 10:t.data.list[o].supply_bind_status="否";break;case 20:t.data.list[o].supply_bind_status="部分";break;case 30:t.data.list[o].supply_bind_status="是"}t.data.list[o].options={text:"编辑",option:"id"},e.formOnStock.list.push(t.data.list[o])}e.formOnStock.list.sort(function(t,e){return t=new Date(t.updated_at),(e=new Date(e.updated_at))-t})})},deleteItemList:function(t){var e=this;n.a.deleteItemList(t).then(function(t){t.data?(e.$message({type:"success",message:"删除成功！"}),e.search()):e.$message.error(t.message)})},setShelf:function(t){var e=this;n.a.setShelf(t).then(function(t){t.data?(e.$message({type:"success",message:"操作成功！"}),e.search()):e.$message.error(t.message)})},setTemplate:function(t){var e=this;n.a.setTemplate(t).then(function(t){t.data?(e.delivery.dialogVisible=!1,e.$message({type:"success",message:"操作成功！"}),e.search()):e.$message.error(t.message)})},setShopCategory:function(t){var e=this;n.a.setShopCategory(t).then(function(t){t.data?(e.category.dialogVisible=!1,e.$message({type:"success",message:"操作成功！"}),e.search()):e.$message.error(t.message)})}},components:{TableView:i.a,PaginationView:l.a},mounted:function(){this.search()}},p={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"onStock"},[o("el-form",{ref:"formOnStock",attrs:{model:t.formOnStock.form,rules:t.formOnStock.rules,"label-width":"100px",size:"medium"}},[o("el-row",[o("el-col",{attrs:{span:6,offset:1}},[o("el-form-item",{attrs:{label:"商品名称：",prop:"title"}},[o("el-input",{model:{value:t.formOnStock.form.title,callback:function(e){t.$set(t.formOnStock.form,"title",e)},expression:"formOnStock.form.title"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:7,offset:1}},[o("el-form-item",{attrs:{label:"商品货号：",prop:"art_no"}},[o("el-input",{model:{value:t.formOnStock.form.art_no,callback:function(e){t.$set(t.formOnStock.form,"art_no",e)},expression:"formOnStock.form.art_no"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:6,offset:1}},[o("el-form-item",{attrs:{label:"店铺分类：",prop:"shop_category_id"}},[o("el-cascader",{attrs:{options:t.categoryList},on:{change:t.getCategoryId},model:{value:t.formOnStock.form.shop_category_list,callback:function(e){t.$set(t.formOnStock.form,"shop_category_list",e)},expression:"formOnStock.form.shop_category_list"}})],1)],1)],1),t._v(" "),o("el-row",[o("el-col",{attrs:{span:6,offset:1}},[o("el-form-item",{attrs:{label:"供应链绑定：",prop:"supply_bind_status"}},[o("el-select",{model:{value:t.formOnStock.form.supply_bind_status,callback:function(e){t.$set(t.formOnStock.form,"supply_bind_status",e)},expression:"formOnStock.form.supply_bind_status"}},[o("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),o("el-option",{attrs:{label:"是",value:"30"}}),t._v(" "),o("el-option",{attrs:{label:"否",value:"10"}}),t._v(" "),o("el-option",{attrs:{label:"部分",value:"20"}})],1)],1)],1),t._v(" "),o("el-col",{attrs:{span:7,offset:1}},[o("el-form-item",{attrs:{label:"销售价格："}},[o("el-col",{attrs:{span:11}},[o("el-form-item",{attrs:{prop:"min_price"}},[o("el-input",{model:{value:t.formOnStock.form.min_price,callback:function(e){t.$set(t.formOnStock.form,"min_price",e)},expression:"formOnStock.form.min_price"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:2}},[t._v("到")]),t._v(" "),o("el-col",{attrs:{span:11}},[o("el-form-item",{attrs:{prop:"max_price"}},[o("el-input",{model:{value:t.formOnStock.form.max_price,callback:function(e){t.$set(t.formOnStock.form,"max_price",e)},expression:"formOnStock.form.max_price"}})],1)],1)],1)],1),t._v(" "),o("el-col",{attrs:{span:6,offset:1}},[o("el-form-item",{attrs:{label:"运费模板：",prop:"logistics_template_id"}},[o("el-select",{model:{value:t.formOnStock.form.logistics_template_id,callback:function(e){t.$set(t.formOnStock.form,"logistics_template_id",e)},expression:"formOnStock.form.logistics_template_id"}},t._l(t.deliveryTplUpList,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)],1)],1),t._v(" "),o("el-row",[o("el-col",{attrs:{span:6,offset:1}},[o("el-form-item",{attrs:{label:"条形码：",prop:"bar_code"}},[o("el-input",{model:{value:t.formOnStock.form.bar_code,callback:function(e){t.$set(t.formOnStock.form,"bar_code",e)},expression:"formOnStock.form.bar_code"}})],1)],1)],1),t._v(" "),o("el-row",[o("el-col",{attrs:{span:6,offset:9}},[o("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),o("el-button",{attrs:{type:"default"},on:{click:t.resetForm}},[t._v("清空条件")])],1)],1)],1),t._v(" "),o("el-row",{directives:[{name:"show",rawName:"v-show",value:t.formOnStock.list.length,expression:"formOnStock.list.length"}],staticClass:"btn-group"},[o("el-button",{attrs:{size:"medium",disabled:!t.formOnStock.selectList.length},on:{click:t.deleteBtn}},[t._v("删除")]),t._v(" "),o("el-button",{attrs:{size:"medium",disabled:!t.formOnStock.selectList.length},on:{click:t.setShelfBtn}},[t._v("批量上架")]),t._v(" "),o("el-button",{attrs:{size:"medium",disabled:!t.formOnStock.selectList.length},on:{click:t.showCategory}},[t._v("调整商品分类")]),t._v(" "),o("el-button",{attrs:{size:"medium",disabled:!t.formOnStock.selectList.length},on:{click:t.showTemplate}},[t._v("调整运费模板")]),t._v(" "),o("el-button",{attrs:{size:"medium"},on:{click:t.exportGoodTable}},[t._v("导出")])],1),t._v(" "),o("div",{staticClass:"table"},[o("table-view",{attrs:{tableName:t.formOnStock.name,selection:!0,loading:t.formOnStock.loading,columns:1==t.biz_mode?t.formOnStock.columns:t.formOnStock.columns_enter,pageList:t.formOnStock.list},on:{"select-change":t.handleSelectChange}})],1),t._v(" "),o("pagination-view",{directives:[{name:"show",rawName:"v-show",value:t.formOnStock.list.length,expression:"formOnStock.list.length"}],attrs:{paginationName:t.formOnStock.name,total:t.formOnStock.total,currentPage:t.formOnStock.form.page},on:{"size-change":t.handleSizeChange,"current-change":t.handleNumberChange}}),t._v(" "),o("table",{attrs:{id:"export-form"}},[t._m(0),t._v(" "),t._l(t.exportList,function(e,s){return o("tr",{key:s},[o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.id))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s("("+e.art_no))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s("("+e.title))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.brand))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s("("+e.barcode))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.store))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.sku_id))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.spec_text))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.sell_price))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.category_primary))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.category_secondary))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.category_third))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.trade_type))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.tax_rate))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.status))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.weight))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.freight_template))]),t._v(" "),o("td",{staticStyle:{"mso-number-format":"'\\@'"}},[t._v(t._s(e.free_refund))])])})],2),t._v(" "),o("el-dialog",{attrs:{title:"选择运费模板",width:"30%",visible:t.delivery.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){return t.$set(t.delivery,"dialogVisible",e)}}},[o("el-row",[o("el-col",{attrs:{offset:5}},[o("el-form",{attrs:{model:t.delivery.form,size:"medium"}},[o("el-form-item",{attrs:{label:"运费模板："}},[o("el-select",{model:{value:t.delivery.form.freight_template_id,callback:function(e){t.$set(t.delivery.form,"freight_template_id",e)},expression:"delivery.form.freight_template_id"}},t._l(t.deliveryTplUpList,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.cancelTempDialog}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.setTemplateBtn}},[t._v("确 定")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"调整店铺分类",width:"30%",visible:t.category.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){return t.$set(t.category,"dialogVisible",e)}}},[o("el-row",[o("el-col",{attrs:{offset:5}},[o("el-form",{attrs:{model:t.category.form,size:"medium"}},[o("el-form-item",{attrs:{label:"店铺分类："}},[o("el-cascader",{attrs:{options:t.categoryList,"show-all-levels":!1},model:{value:t.category.form.category_id,callback:function(e){t.$set(t.category.form,"category_id",e)},expression:"category.form.category_id"}})],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.cancelCategoryDialog}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.setCategoryBtn}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("tr",[o("td",[t._v("商品id")]),t._v(" "),o("td",[t._v("商品货号")]),t._v(" "),o("td",[t._v("商品名称")]),t._v(" "),o("td",[t._v("品牌")]),t._v(" "),o("td",[t._v("条形码")]),t._v(" "),o("td",[t._v("库存")]),t._v(" "),o("td",[t._v("SKU-ID")]),t._v(" "),o("td",[t._v("规格")]),t._v(" "),o("td",[t._v("售价")]),t._v(" "),o("td",[t._v("一级类目")]),t._v(" "),o("td",[t._v("二级类目")]),t._v(" "),o("td",[t._v("三级类目")]),t._v(" "),o("td",[t._v("贸易类型")]),t._v(" "),o("td",[t._v("税率")]),t._v(" "),o("td",[t._v("状态")]),t._v(" "),o("td",[t._v("商品重量(kg)")]),t._v(" "),o("td",[t._v("运费模板")]),t._v(" "),o("td",[t._v("是否支持七天无理由")])])}]};var g=o("C7Lr")(u,p,!1,function(t){o("Pclv")},"data-v-95c4ca20",null);e.default=g.exports}});