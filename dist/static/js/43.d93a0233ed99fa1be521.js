webpackJsonp([43],{S3J0:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("1G+u"),n=e("VXZc"),l=e("Cotb"),s=e("F5v2"),o={data:function(){var a=this;return{value:[],package_info:"",info:{package_id:"",apply_id:""},form:{page:1,page_size:20,package_id:""},couponList:[],total:0,couponColumns:[{label:"优惠劵ID",field:"id",align:"center"},{label:"优惠劵名称",field:"name",align:"center"},{label:"门槛金额",field:"limit_money",align:"center"},{label:"优惠金额",field:"deduct_money",align:"center"},{label:"发放数量",field:"send_quantity",align:"center"},{label:"领取数量",field:"user_obtain_quantity",align:"center"},{label:"使用数量",field:"user_used_quantity",align:"center"},{label:"优惠劵状态",field:"valid_status",align:"center"}],centerDialogVisible:!1,list:[],columns:[{label:"优惠劵ID",field:"id",align:"center"},{label:"优惠劵名称",field:"name",align:"center"},{label:"门槛金额",field:"limit_money",align:"center"},{label:"优惠金额",field:"deduct_money",align:"center"},{label:"发放数量",field:"send_quantity",align:"center"},{label:"领取数量",field:"user_obtain_quantity",align:"center"},{label:"使用数量",field:"user_used_quantity",align:"center"},{label:"创建时间",field:"created_at",align:"center"},{label:"优惠劵状态",field:"valid_status",align:"center"},{label:"审核状态",field:"verify_status",align:"center"},{label:"操作",align:"center",actions:[{label:"删除",type:"text",size:"medium",disable:function(a,t){return!1},click:function(t,e){a.deleteCoupons(e.id)}}]}],savaGiftData:{package_id:"",coupon_ids:[]}}},methods:{getGiftCouponList:function(a){var t=this;l.a.getGiftCouponList(a).then(function(a){for(var e in t.couponList=[],t.total=a.data.total_count,a.data.data){var i=a.data.data[e].valid_status,n=a.data.data[e].status;switch(i){case"invalid":a.data.data[e].valid_status="已作废";break;case"valid":a.data.data[e].valid_status="有效中"}switch(n){case 1:a.data.data[e].status="有效";break;case 0:a.data.data[e].status="已作废";break;case 2:a.data.data[e].status="无报名审核通过记录";break;case 3:a.data.data[e].status="待生效";break;case 4:a.data.data[e].status="生效中";break;case 5:a.data.data[e].status="已失效"}t.couponList.push(a.data.data[e])}}).catch(function(a){console.log(a)})},getGiftInfo:function(a){var t=this;l.a.getGiftInfo(a).then(function(a){if(t.package_info=a.data.package_info,t.list=[],""!=a.data.data)for(var e in a.data.coupon_list.data){switch(a.data.coupon_list.data[e].status){case 1:a.data.coupon_list.data[e].status="有效";break;case 0:a.data.coupon_list.data[e].status="已作废";break;case 2:a.data.coupon_list.data[e].status="无报名审核通过记录";break;case 3:a.data.coupon_list.data[e].status="待生效";break;case 4:a.data.coupon_list.data[e].status="生效中";break;case 5:a.data.coupon_list.data[e].status="已失效"}switch(a.data.coupon_list.data[e].verify_status){case"agree":a.data.coupon_list.data[e].verify_status="审核通过";break;case"refuse":a.data.coupon_list.data[e].verify_status="审核拒绝";break;case"pending":a.data.coupon_list.data[e].verify_status="审核中"}t.list.push(a.data.coupon_list.data[e])}})},selectable:function(a){return"有效中"==a.valid_status},clickCoupon:function(){this.centerDialogVisible=!0,this.form.package_id=Object(s.a)().package_id,this.getGiftCouponList(this.form)},sizeChange:function(a){this.form.page_size=a,this.getGiftCouponList(this.form)},pageChange:function(a){this.form.page=a,this.getGiftCouponList(this.form)},handleSelectionChange:function(a){this.value=a},couponYes:function(){var a=[];for(var t in this.list)a.push(this.list[t].id);for(var e in this.value)a.indexOf(this.value[e].id)<0&&this.list.push(this.value[e]);this.centerDialogVisible=!1},deleteCoupons:function(a){this.list=this.list.filter(function(t){return t.id!=a})},saveGift:function(a){var t=this;l.a.saveGift(a).then(function(a){t.$router.push({name:"giftpackage"})})},clickSavaGift:function(){this.savaGiftData.package_id=Object(s.a)().package_id,this.savaGiftData.coupon_ids=[],this.savaGiftData.apply_id=this.info.apply_id;var a=this.list;for(var t in a)this.savaGiftData.coupon_ids.push(a[t].id);this.saveGift(this.savaGiftData)}},created:function(){this.info.package_id=this.$route.query.package_id,this.info.apply_id=this.$route.query.apply_id,this.info.apply_id?this.getGiftInfo(this.info):this.getGiftInfo({package_id:this.info.package_id})},components:{TableView:i.a,PaginationView:n.a}},c={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("section",{staticClass:"giftInfo"},["refuse"==a.package_info.apply_status?e("p",[a._v("审核驳回原因："+a._s(a.package_info.refuse_reason))]):a._e(),a._v(" "),e("h3",[a._v("礼包信息")]),a._v(" "),e("p",[a._v("礼包ID："+a._s(a.package_info.id))]),a._v(" "),e("p",[a._v("礼包名称："+a._s(a.package_info.name))]),a._v(" "),e("p",[a._v("礼包兑换码："+a._s(a.package_info.exchange_code))]),a._v(" "),e("p",[a._v("礼包金额："+a._s(a.package_info.package_money))]),a._v(" "),e("p",[a._v("优惠劵数量："+a._s(a.package_info.coupon_num))]),a._v(" "),e("p",[a._v("每人限领数量："+a._s(a.package_info.user_get_limit))]),a._v(" "),e("p",[a._v("每家店铺可报名优惠价数量："+a._s(a.package_info.available_apply_num))]),a._v(" "),e("p",[a._v("发放数量："+a._s(a.package_info.send_quantity))]),a._v(" "),e("p",[a._v("创建时间："+a._s(a.package_info.created_at))]),a._v(" "),e("p",[a._v("报名开始时间："+a._s(a.package_info.apply_start_time))]),a._v(" "),e("p",[a._v("领取开始时间："+a._s(a.package_info.obtain_start_time))]),a._v(" "),e("p",[a._v("领取结束时间："+a._s(a.package_info.obtain_end_time))]),a._v(" "),e("h3",[a._v("优惠劵信息")]),a._v(" "),e("p"),a._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:a.clickCoupon}},[a._v("选择优惠劵")]),a._v(" "),e("p"),a._v(" "),e("el-table",{staticClass:"table",attrs:{data:a.list,border:"",align:"center"}},[e("el-table-column",{attrs:{align:"center",label:"优惠劵ID",prop:"id"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"优惠劵名称"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("a",{staticClass:"goods_url",attrs:{href:"/goods-activity/activity/ticketDetail?id="+t.row.id,target:"_blank"}},[a._v(a._s(t.row.name))])]}}])}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"门槛金额",prop:"limit_money"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"优惠金额",prop:"deduct_money"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"发放数量",prop:"send_quantity"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"领取数量",prop:"user_obtain_quantity"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"使用数量",prop:"user_used_quantity"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"created_at"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"优惠劵状态",prop:"valid_status"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"审核状态",prop:"verify_status"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("a",{on:{click:function(e){return a.deleteCoupons(t.row.id)}}},[a._v("删除")])]}}])})],1),a._v(" "),e("el-dialog",{attrs:{title:"优惠劵列表",visible:a.centerDialogVisible,width:"60%",center:""},on:{"update:visible":function(t){a.centerDialogVisible=t}}},[e("el-table",{staticClass:"table",attrs:{data:a.couponList,border:"",align:"center"},on:{"selection-change":a.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"35",selectable:a.selectable}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"优惠劵ID",prop:"id"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"优惠劵名称",prop:"name"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("a",{staticClass:"goods_url",attrs:{href:"/goods-activity/activity/ticketDetail?id="+t.row.id,target:"_blank"}},[a._v(a._s(t.row.name))])]}}])}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"门槛金额",prop:"limit_money"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"优惠金额",prop:"deduct_money"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"发放数量",prop:"send_quantity"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"领取数量",prop:"user_obtain_quantity"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"使用数量",prop:"user_used_quantity"}}),a._v(" "),e("el-table-column",{attrs:{align:"center",label:"优惠劵状态",prop:"status"}})],1),a._v(" "),e("pagination-view",{attrs:{currentPage:a.form.page,total:a.total},on:{"size-change":a.sizeChange,"current-change":a.pageChange}}),a._v(" "),e("div",{staticClass:"isSumit"},[e("el-button",{on:{click:function(t){a.centerDialogVisible=!1}}},[a._v("取 消")]),a._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:a.couponYes}},[a._v("确 定")])],1)],1),a._v(" "),e("p"),a._v(" "),e("el-button",{staticClass:"submit",on:{click:a.clickSavaGift}},[a._v("提交")])],1)},staticRenderFns:[]};var r=e("C7Lr")(o,c,!1,function(a){e("h0AP")},"data-v-7f142b50",null);t.default=r.exports},h0AP:function(a,t){}});