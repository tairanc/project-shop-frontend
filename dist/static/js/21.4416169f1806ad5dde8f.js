webpackJsonp([21],{"8f/q":function(e,t,a){e.exports=a.p+"static/img/mb.082b889.xlsx"},Mg2o:function(e,t){},PYWA:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("NcNL"),s=a.n(r),n=a("wJ7o"),o=a.n(n),i=a("8f/q"),l=a.n(i),c=a("lMF6");var u="",f={data:function(){return{url:"",md:l.a,fileList:[],updataList:[],allDataLength:0,successArray:"",failureArray:[],showArrayInfo:!0,upFileType:"",list:[]}},methods:{handleChange:function(e,t){console.log(t)},successUpdata:function(e,t,a){this.$message({type:"success",message:"上传成功"})},errorUPdata:function(e,t,a){this.$message({type:"error",message:"上传失败"})},init_batch_delivery:function(){var e=this;c.a.init_batch_delivery().then(function(t){e.url=t.data.demo_dir,window.open(e.url)})},downMB:function(){var e=o.a.utils.table_to_book(document.querySelector("#rebateSetTable")),t=o.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{s.a.saveAs(new Blob([t],{type:"application/octet-stream"}),"批量发货模版.xlsx")}catch(e){"undefined"!=typeof console&&console.log(e,t)}return t},batch_delivery:function(e){var t,a,r=this,s=this,n=(t=1,a=100,Math.floor(Math.random()*(a-t+1))+t),o=(new Date).getTime()+"a"+n;u=o;var i={unique:o,list:e};c.a.batch_delivery(i).then(function(e){r.$message({type:"success",message:"上传成功"}),s.packBatchInfo()})},packBatchInfo:function(){var e=this,t={unique:u};c.a.packBatchConsoleInfo(t).then(function(t){"loading"==t.status?(e.showArrayInfo=!1,e.successArray="0",e.failureArray=t.console):(e.showArrayInfo=!0,e.allDataLength=parseInt(t.totalCount)||0,e.successArray=t.processedCount,e.failureArray=("loading"==e.upFileType?[]:e.failureArray).concat(t.console)),"loading"!=t.status&&"running"!=t.status||(e.upFileType=t.status,setTimeout(function(){e.packBatchInfo()},1e3))})},inputNew:function(){this.upFileType="",this.$refs.importfxx.value=null,this.allDataLength=0,this.successArray="",this.failureArray=[]},clickDr:function(e){var t=this,a=setInterval(function(){this.flag?clearInterval(a):""!=e&&t.batch_delivery(e)},500)},importfxx:function(e,t){var r=this,s=(this.$refs.inputer,s||window.event||t);this.file=s.currentTarget.files[0];var n=this.file,o=new FileReader;FileReader.prototype.readAsBinaryString=function(e){var t,s,n="",o=new FileReader;o.onload=function(e){for(var i=new Uint8Array(o.result),l=i.byteLength,c=0;c<l;c++)n+=String.fromCharCode(i[c]);var u=a("wJ7o");for(var f in t=u.read(n,{type:"binary"}),s=u.utils.sheet_to_json(t.Sheets[t.SheetNames[0]]),this.updataList=[],s){var p={order_shop_no:"",corp_code:"",express_no:"",order_good_no:"",num:""};p.order_shop_no=s[f]["店铺订单号"],p.corp_code=s[f]["物流公司编码"],p.express_no=s[f]["运单号"],p.order_good_no=s[f]["商品级订单号"],p.num=s[f]["发货数量"],this.updataList.push(p)}r.batch_delivery(this.updataList)},o.readAsArrayBuffer(e)},o.readAsBinaryString(n)}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"batchShipment"},[e._m(0),e._v(" "),a("el-form",{staticStyle:{"margin-top":"50px"}},[a("el-row",[a("el-col",{attrs:{offset:1,span:6}},[a("el-form-item",[a("input",{ref:"importfxx",staticClass:"ipt",attrs:{id:"upload",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:function(t){return e.importfxx(this,t)}}})])],1),e._v(" "),a("el-col",{attrs:{offset:1,span:6}},[a("a",{staticClass:"goods_url",attrs:{href:e.md,download:"batch_delivery.xlsx"}},[e._v("下载模版")])])],1),e._v(" "),a("el-row",[""!=e.successArray?a("el-col",{staticClass:"height-scroll",attrs:{offset:1,span:18}},[e.showArrayInfo?a("p",[e._v("需要发货总包裹数量："+e._s(e.allDataLength)+"条")]):e._e(),e._v(" "),e.showArrayInfo?a("p",[e._v("已处理的包裹数量："+e._s(e.successArray)+"条")]):e._e(),e._v(" "),""!=e.failureArray?a("div",[a("p",[e._v("订单信息：")]),e._v(" "),e._l(e.failureArray,function(t,r){return a("p",{key:r},[e._v(e._s(t))])})],2):e._e()]):e._e()],1),e._v(" "),a("el-row",[a("el-col",{attrs:{offset:1,span:6}},[a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.inputNew}},[e._v("重置")])],1)],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("span",{staticStyle:{"font-weight":"700",color:"#303133"}},[this._v("批量导入发货订单")]),this._v(" "),t("span",{staticStyle:{fontSize:"14px"}},[this._v("(批量导入订单只支持一个店铺订单对应一个运单号的情况)")])])}]};var h=a("C7Lr")(f,p,!1,function(e){a("Mg2o")},"data-v-6a6fdf03",null);t.default=h.exports}});