webpackJsonp([12],{"2Zbh":function(e,t){},"9YLi":function(e,t,s){"use strict";var n=s("3cXf"),i=s.n(n),a=s("4YfN"),l=s.n(a),o=s("qsHl"),r=(s("kIQj"),s("2AkA"),s("VXZc")),c=s("2bvH"),m={name:"imguse",data:function(){return{moveFileShow:!1,inputImgName:"",filterText:"",imgdir:[],setimgdata:[],imgSelectList:[],fileSelectList:[],imglist:[],img_total_count:0,storeItem:null,timeClickshow:!1,nameClickshow:!1,newFileName:"",newFileList:[],defaultProps:{children:"children",label:function(e){return e.name.length>10&&(e.name=e.name.slice(0,10)+"..."),e.name}},postparams:{file_id:"",keyword:"",page:1,page_size:20,order_bys:"created_at|desc"}}},components:{PaginationView:r.a},methods:l()({},Object(c.b)(["setImgSelect"]),{handleExceed:function(e,t){this.$message.warning("已达到最大上传数量")},beforeAvatarUpload:function(e){var t=e.size/1024/1024<3;return t||this.$message.error("文件太大，请更换图片!"),t},upload:function(e){var t=this,s=new FileReader;s.readAsDataURL(e.file),s.onload=function(s){o.a.uploadImg({file_name:e.file.name,file_content:s.target.result,target_type:"20",image_type:"item",file_id:t.storeItem.id}).then(function(e){0==e.code&&t.getImgFun(t.postparams)})}},handleNodeClick:function(e,t){var s=e.id;this.postparams={file_id:"",keyword:"",page:1,page_size:20,order_bys:"created_at|desc"},this.postparams.file_id=s,this.storeItem=e,this.getImgFun(this.postparams),this.newFileList=[],this.getNodeName(t)},getNodeName:function(e){0!=e.parent.level?(this.newFileList.unshift(e.data.name),this.getNodeName(e.parent)):(this.newFileList.unshift(e.data.name),this.joinNodeName())},joinNodeName:function(){this.newFileName=this.newFileList.join("    >    ")},moveHandleNodeClick:function(e){},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},addNewFile:function(){var e=this;this.$prompt("请输入文件夹名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"名称不能为空"}).then(function(t){var s={name:t.value,parent_id:e.storeItem.id,order:0};o.a.createImgFile(s).then(e.getImgFun(e.postparams),o.a.getImgDir({}).then(function(t){e.imgdir=t.data}))}).catch(function(){e.$message({type:"info",message:"取消输入"})})},reName:function(){var e=this,t={};this.imglist.map(function(e,s){e.select&&(t=e)}),this.$prompt("请输入新名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"名称不能为空"}).then(function(s){var n=s.value,i=t.id,a={name:n};"image"===t.content_type?a.image_id=i:a.file_id=i,o.a.renameImgFile(a).then(e.$set(t,"name",n))}).catch(function(){e.$message({type:"info",message:"取消输入"})})},selectItem:function(e){this.$set(e,"select",!e.select);var t=JSON.parse(i()(this.selectImgList));if(e.select)"image"===e.content_type&&(this.selcctImgListUrl.length>0?-1==this.selcctImgListUrl.indexOf(e.url)&&(t.length>9?(this.$message({message:"已达到最大上传数量",type:"warning"}),this.$set(e,"select",!e.select)):(t.push(e),this.imgSelectList.push(e.id))):(this.imgSelectList.push(e.id),t.push(e)));else if("image"===e.content_type&&this.selcctImgListUrl.length>0){var s=this.selcctImgListUrl.indexOf(e.url);-1!=s&&(t.splice(s,1),this.imgSelectList.splice(s,1))}this.setImgSelect(t)},searchImg:function(){var e=JSON.parse(i()(this.postparams));e.keyword=this.inputImgName.trim(),this.getImgFun(e)},handleSizeChange:function(e){this.postparams.page_size=e,this.getImgFun(this.postparams)},handleNumberChange:function(e){this.postparams.page=e,this.getImgFun(this.postparams)},getImgFun:function(e){var t=this,s=this;s.fileSelectList=[],s.imgSelectList=[],o.a.getImgListJustImg(e).then(function(e){var n=[];0===e.code&&e.data.data.length>0&&e.data.data.map(function(e,s){"image"==e.content_type&&(-1!=t.selcctImgListUrl.indexOf(e.url)?e.select=!0:e.select=!1,n.push(e))}),s.imglist=n,s.img_total_count=e.data.total_count})}}),computed:l()({},Object(c.c)(["selectImgList","selcctImgListUrl"])),mounted:function(){var e=this;o.a.getImgDir({}).then(function(t){var s=t.data;if(e.imgdir=s,s&&s.length>0){e.newFileName=s[0].name;var n=s[0].id;e.postparams.file_id=n,e.storeItem=s[0],e.getImgFun(e.postparams)}})},watch:{filterText:function(e){this.$refs.tree2.filter(e)}}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"imguse"},[s("el-card",{staticClass:"box-card"},[s("el-container",[s("el-aside",[s("div",{staticClass:"imgspace_left_name"},[e._v("图片空间")]),e._v(" "),s("el-input",{attrs:{size:"small",placeholder:"搜索文件夹"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),s("el-tree",{ref:"tree2",staticClass:"filter-tree",attrs:{data:e.imgdir,props:e.defaultProps,"default-expand-all":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),s("el-main",{staticClass:"imgspace_imgcontent"},[s("div",{staticClass:"imgspace_right_head"},[s("div",{staticClass:"imspace_right_position"},[e._v("当前文件名： "+e._s(e.newFileName))]),e._v(" "),s("el-upload",{attrs:{action:"11",accept:"image/*",multiple:"",limit:200,"on-exceed":e.handleExceed,"before-upload":e.beforeAvatarUpload,"http-request":e.upload,"show-file-list":!1}},[s("el-button",{attrs:{size:"small"}},[e._v("上传图片")])],1),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.addNewFile}},[e._v("新建文件夹")]),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.imgSelectList.length,expression:"imgSelectList.length == 1"}],attrs:{size:"small"},on:{click:e.reName}},[e._v("重命名")]),e._v(" "),s("div",{staticClass:"imgspace_right_head_input"},[s("el-input",{attrs:{placeholder:"图片名称搜索",clearable:"",size:"small"},model:{value:e.inputImgName,callback:function(t){e.inputImgName=t},expression:"inputImgName"}}),e._v(" "),s("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"small"},on:{click:e.searchImg},slot:"append"})],1)],1),e._v(" "),s("div",{staticClass:"imgspace_content"},[e.imglist.length>0?s("div",{staticClass:"imgspace_content_imgui"},e._l(e.imglist,function(t,n){return s("div",{key:n},["image"===t.content_type?s("div",{class:-1!=e.selcctImgListUrl.indexOf(t.url)?"imgspace_imgcontent_li_select":"imgspace_imgcontent_li",on:{click:function(s){return e.selectItem(t)}}},[s("img",{attrs:{src:t.url+"_m.jpg",alt:""}}),e._v(" "),t.name.length<10?s("span",[e._v(e._s(t.name))]):s("el-popover",{attrs:{placement:"top",width:"200",trigger:"hover",content:t.name}},[s("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.name.slice(0,10)+"..."))])])],1):e._e()])}),0):e._e(),e._v(" "),s("pagination-view",{directives:[{name:"show",rawName:"v-show",value:e.imglist.length,expression:"imglist.length"}],attrs:{paginationName:"",total:e.img_total_count,currentPage:e.postparams.page,pagesize:20},on:{"size-change":e.handleSizeChange,"current-change":e.handleNumberChange}})],1)])],1)],1)],1)},staticRenderFns:[]};var g=s("C7Lr")(m,p,!1,function(e){s("vEpW"),s("IkJj")},"data-v-47df314b",null);t.a=g.exports},IkJj:function(e,t){},"QR/j":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("3cXf"),i=s.n(n),a=s("4YfN"),l=s.n(a),o=s("1G+u"),r=s("3RBe"),c=s("VXZc"),m=s("9YLi"),p=s("2bvH"),g=s("IcnI"),h={data:function(){return{imgSeclect:!1,replyView:!1,len:"",list:[],textNum:100,textNumTo:200,storeselectImgList:[],activeName:"commentsList",centerComplaintVisible:!1,complaint:{rate_id:"",content:"",images:[]},replys:{rate_id:"",reply:""},nice:{rate_id:"",is_essence:""},trade_time:[],formOnComments:{total:0,form:{title:"",start_date:"",end_date:"",grade:"",is_essence:0,has_image:0,has_reply:0,has_content:0,has_like:0,page_size:20,page:1},list:[]}}},methods:l()({},Object(p.b)(["getBindCategoryList","getGoodsInfoList","setImgSelect","setSkuSelect"]),{getCommentList:function(e){var t=this;r.a.getCommentList(e).then(function(e){t.formOnComments.total=e.data.total_count,t.formOnComments.list=[];var s=e.data.list;for(var n in t.trade_time&&(t.formOnComments.form.start_date=t.trade_time[0],t.formOnComments.form.end_date=t.trade_time[1]),s){switch(s[n].grade){case 10:s[n].grade="差评";break;case 20:s[n].grade="中评";break;case 30:s[n].grade="好评"}switch(s[n].is_essence){case 0:s[n].is_essence="一般评价";break;case 1:s[n].is_essence="精华评论"}t.formOnComments.list.push(s[n])}})},search:function(){this.trade_time&&(this.formOnComments.form.start_date=this.trade_time[0],this.formOnComments.form.end_date=this.trade_time[1]),this.getCommentList(this.formOnComments.form)},niceClick:function(e){var t=this;this.$confirm("每个店铺最多设置10条精华评论, 是否设置为精华?","设置精华",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.nice.rate_id=e.id,t.nice.is_essence=!0,r.a.set_essence(t.nice).then(function(e){t.$message({type:"success",message:"设置成功!"}),t.search()}).catch(function(e){this.$message({type:"error",message:"设置失败!"})})}).catch(function(){t.$message({type:"info",message:"已取消设置"})})},cancelNiceClick:function(e){var t=this;this.$confirm("是否取消精华?","取消精华",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.nice.rate_id=e.id,t.nice.is_essence=!1,r.a.set_essence(t.nice).then(function(e){t.$message({type:"success",message:"设置成功!"}),t.search()}).catch(function(e){this.$message({type:"error",message:"设置失败!"})})}).catch(function(){t.$message({type:"info",message:"已取消设置"})})},centerComplaint:function(e){this.centerComplaintVisible=!0,this.complaint.images=[],this.complaint.content="",this.complaint.rate_id=e.id,g.a.commit("delImgList")},submitComplaint:function(e){var t=this;if(this.selectImgList.length>5)this.$message({type:"warning",message:"图片仅限五张!"});else{for(var s in this.complaint.images=[],this.selectImgList)this.complaint.images.push(this.selectImgList[s].url);r.a.create(e).then(function(e){t.centerComplaintVisible=!1})}},clickReply:function(e){this.replys.rate_id=e.id,this.replys.reply=e.reply,this.replyView=!0},saveReply:function(e){var t=this;r.a.reply(e).then(function(e){t.replyView=!1,t.search()})},sizeChange:function(e){this.formOnComments.form.page_size=e,this.getCommentList(this.formOnComments.form)},pageChange:function(e){this.formOnComments.form.page=e,this.getCommentList(this.formOnComments.form)},hideImgSelect:function(){this.setImgSelect(this.storeselectImgList),this.imgSeclect=!1},sureImgSelect:function(){this.imgSeclect=!1},deleteImg:function(e){this.selectImgList.splice(e,1),this.setImgSelect(this.selectImgList)},showImgSelect:function(){this.storeselectImgList=JSON.parse(i()(this.selectImgList)),this.imgSeclect=!0},gradeChange:function(){this.search()},is_essenceChange:function(){0==this.formOnComments.form.is_essence?this.formOnComments.form.is_essence=1:this.formOnComments.form.is_essence=0,this.search()},has_imageChange:function(){0==this.formOnComments.form.has_image?this.formOnComments.form.has_image=1:this.formOnComments.form.has_image=0,this.search()},has_replyChange:function(){0==this.formOnComments.form.has_reply?this.formOnComments.form.has_reply=1:this.formOnComments.form.has_reply=0,this.search()},has_contentChange:function(){0==this.formOnComments.form.has_content?this.formOnComments.form.has_content=1:this.formOnComments.form.has_content=0,this.search()},has_likeChange:function(){0==this.formOnComments.form.has_like?this.formOnComments.form.has_like=1:this.formOnComments.form.has_like=0,this.search()}}),created:function(){this.search()},computed:l()({},Object(p.c)(["bindCategoryList","goodsIntInfo","selectImgList","skuitem","sellImgSrc"])),components:{TableView:o.a,PaginationView:c.a,Imguse:m.a}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"manage"},[s("el-form",{ref:"formOnComments",attrs:{model:e.formOnComments.form,rules:e.formOnComments.rules,"label-width":"100px",size:"medium"}},[s("el-row",[s("el-col",{attrs:{span:4,offset:1}},[s("el-form-item",{attrs:{prop:"title",label:"商品名称："}},[s("el-input",{model:{value:e.formOnComments.form.title,callback:function(t){e.$set(e.formOnComments.form,"title",t)},expression:"formOnComments.form.title"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12,offset:1}},[s("el-form-item",{attrs:{label:"评论时间:",prop:"trade_time"}},[s("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.trade_time,callback:function(t){e.trade_time=t},expression:"trade_time"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:5,offset:1}},[s("el-form-item",{attrs:{label:"评论分类：",prop:"grade"}},[s("el-select",{attrs:{placeholder:"全部"},on:{change:e.gradeChange},model:{value:e.formOnComments.form.grade,callback:function(t){e.$set(e.formOnComments.form,"grade",t)},expression:"formOnComments.form.grade"}},[s("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),s("el-option",{attrs:{label:"差评",value:"10"}}),e._v(" "),s("el-option",{attrs:{label:"中评",value:"20"}}),e._v(" "),s("el-option",{attrs:{label:"好评",value:"30"}})],1)],1)],1),e._v(" "),s("el-col",{attrs:{span:10,offset:1}},[s("el-checkbox",{attrs:{label:"精华评论"},on:{change:e.is_essenceChange}}),e._v(" "),s("el-checkbox",{attrs:{label:"有晒图"},on:{change:e.has_imageChange}}),e._v(" "),s("el-checkbox",{attrs:{label:"有回复"},on:{change:e.has_replyChange}}),e._v(" "),s("el-checkbox",{attrs:{label:"有内容"},on:{change:e.has_contentChange}}),e._v(" "),s("el-checkbox",{attrs:{label:"有点赞"},on:{change:e.has_likeChange}})],1)],1),e._v(" "),s("el-row",[s("el-col",{staticClass:"tc",attrs:{span:20,offset:1}},[s("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")])],1)],1)],1),e._v(" "),s("p"),e._v(" "),s("el-table",{staticClass:"table",attrs:{data:e.formOnComments.list,border:"",align:"center"}},[s("el-table-column",{attrs:{align:"center",label:"评论等级",prop:"grade"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"订单编号",prop:"order_no"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"评价时间",prop:"created_at"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"评论内容",prop:"content"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v("[初次评论]："),t.row.content?s("span",[e._v(e._s(t.row.content))]):s("span",[e._v("默认评论")])]),e._v(" "),t.row.images?s("p",{staticClass:"commentsImg"},e._l(t.row.images,function(e,t){return s("img",{key:"img"+t,attrs:{src:e+"_t.jpg"}})}),0):e._e(),e._v(" "),t.row.created_at?s("p",[e._v(e._s(t.row.created_at))]):e._e(),e._v(" "),t.row.reply?s("p",[e._v(e._s(t.row.reply))]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"点赞数量",prop:"like_count"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"评论类型",prop:"is_essence"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"商品信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[s("a",{staticClass:"goods_url",attrs:{href:e.defaultUrl("item_id",t.row),target:"_blank"}},[e._v(e._s(t.row.title))])]),e._v(" "),s("p",{staticStyle:{color:"#ff851b"}},[t.row.sell_price?s("span",[e._v("¥"+e._s(t.row.sell_price))]):e._e()])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"评价人"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.is_anonymous&&null!=t.row.nickname?s("span",[e._v(e._s(t.row.nickname))]):e._e(),e._v(" "),0==t.row.is_anonymous&&null==t.row.nickname?s("span",[e._v("****")]):e._e(),e._v(" "),1==t.row.is_anonymous?s("span",[e._v("**** [匿名]")]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.centerComplaint(t.row)}}},[e._v("评论申诉")]),e._v(" "),"一般评价"==t.row.is_essence?s("el-button",{staticStyle:{"margin-left":"0"},attrs:{type:"text"},on:{click:function(s){return e.niceClick(t.row)}}},[e._v("精华设定")]):e._e(),e._v(" "),"一般评价"!=t.row.is_essence?s("el-button",{staticStyle:{"margin-left":"0"},attrs:{type:"text"},on:{click:function(s){return e.cancelNiceClick(t.row)}}},[e._v("取消精华")]):e._e(),e._v(" "),s("el-button",{staticStyle:{"margin-left":"0"},attrs:{type:"text"},on:{click:function(s){return e.clickReply(t.row)}}},[e._v("评论回复")])]}}])})],1),e._v(" "),s("pagination-view",{attrs:{currentPage:e.formOnComments.form.page,total:e.formOnComments.total},on:{"size-change":e.sizeChange,"current-change":e.pageChange}}),e._v(" "),s("el-dialog",{attrs:{title:"对用户差评进行申诉",visible:e.centerComplaintVisible,width:"50%",center:""},on:{"update:visible":function(t){e.centerComplaintVisible=t}}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:7,maxRows:7},placeholder:"说明申诉理由",maxlength:"200"},model:{value:e.complaint.content,callback:function(t){e.$set(e.complaint,"content",t)},expression:"complaint.content"}}),e._v(" "),s("span",[e._v("至少1个字，还可以输入\n          "),""!=e.complaint.content?s("span",[e._v(e._s(e.textNumTo-e.complaint.content.length))]):e._e(),e._v(" "),""==e.complaint.content?s("span",[e._v(e._s(e.textNumTo))]):e._e(),e._v("字")]),e._v(" "),s("div",{staticClass:"img_sepc"},[s("p",[e._v("举证仅限五张")]),e._v(" "),e._l(e.selectImgList,function(t,n){return e.selectImgList.length>0?s("div",{key:n,staticClass:"img_edit"},[s("img",{attrs:{src:t.url+"_t.jpg",alt:""}}),e._v(" "),s("div",{staticClass:"img_delete",on:{click:function(t){return e.deleteImg(n)}}},[s("i",{staticClass:"el-icon-delete"})])]):e._e()}),e._v(" "),s("el-button",{staticStyle:{width:"68px",height:"68px",display:"inline-block","vertical-align":"top"},on:{click:e.showImgSelect}},[s("i",{staticClass:"el-icon-plus"})])],2),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitComplaint(e.complaint)}}},[e._v("提交申诉")]),e._v(" "),s("el-button",{on:{click:function(t){e.centerComplaintVisible=!1}}},[e._v("取消申诉")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"对用户评价进行解释",visible:e.replyView,width:"50%",center:""},on:{"update:visible":function(t){e.replyView=t}}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:7,maxRows:7},placeholder:"说点什么吧～",maxlength:"100"},model:{value:e.replys.reply,callback:function(t){e.$set(e.replys,"reply",t)},expression:"replys.reply"}}),e._v(" "),s("span",[e._v("至少1个字，还可以输入\n          "),null!=this.replys.reply?s("span",[e._v(e._s(e.textNum-this.replys.reply.length))]):e._e(),e._v(" "),null==this.replys.reply?s("span",[e._v(e._s(e.textNum))]):e._e(),e._v("字")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.replyView=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveReply(e.replys)}}},[e._v("保存")])],1)],1),e._v(" "),s("el-dialog",{staticClass:"imgSeclect",attrs:{visible:e.imgSeclect,width:"80%","show-close":!1}},[s("imguse",{ref:"refimguse"}),e._v(" "),s("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.hideImgSelect}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.sureImgSelect}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var f=s("C7Lr")(h,u,!1,function(e){s("2Zbh")},"data-v-2bc915b6",null);t.default=f.exports},vEpW:function(e,t){}});