webpackJsonp([100],{"8JGV":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("BD25"),r=a("lMF6"),o=a("iled"),i=a("F5v2"),l=a("1G+u"),n={data:function(){return{isOwn:!1,list:[],defaultList:[],name:"0",info:"",address:"",obj:"",closable:!1,imageDomain:"",parcel_split:"",path_split:!0,packed_items:[],un_packed_items:[],post_data:[],disabled:!0,path:!0,checkList:[],val:"",columns:[{label:"商品",desFields:"1"},{label:"数量",text:"num",align:"center"},{label:"",field:"after_sale_status",align:"center"}],titles:[{label:"商品",desFields:"1"},{label:"数量",text:"packed_num",align:"center"},{label:"",field:"after_sale_status",align:"center"}],title:[{label:"商品",desFields:"1"},{label:"数量",field:"packed_num",align:"center"},{label:"",field:"after_sale_status",align:"center"}],options:[],value3:"",no:"",rules:{},pathModlie:!1,delivery_type:10,formOnSearch:{form:{order_shop_no:"",corp_id:"",express_no:"",package:[],overseas_corp_id:"",overseas_express_no:"",is_overseas:!1}},editableTabsValue2:"0",editableTabs2:[],tabIndex:1}},methods:{initDelivery:function(e){var t=this;r.a.initDelivery(e).then(function(e){for(var a in t.delivery_type=e.data.delivery_type||10,t.imageDomain=e.data.image_domain,t.defaultList=[],t.formOnSearch.form.order_shop_no=e.data.shop_order_item.no,""==e.data.unpacked_items?t.parcel_split=!0:t.parcel_split=!1,e.data.unpacked_items){null!=(l=e.data.unpacked_items[a].after_sale_status)&&(10==l||20==l||40==l||50==l?e.data.unpacked_items[a].after_sale_status="售后处理中":30==l?e.data.unpacked_items[a].after_sale_status="售后完成":60!=l&&70!=l||(e.data.unpacked_items[a].after_sale_status="")),t.list.push(e.data.unpacked_items[a])}for(var s in e.data.shop_order_item.order_goods)t.defaultList.push(e.data.shop_order_item.order_goods[s]);for(var a in e.data.packed_items){var r=!1;for(var o in e.data.packed_items[a].close=r,e.data.packed_items[a].name=a,e.data.packed_items[a].goods_orders){null!=(l=e.data.packed_items[a].goods_orders[o].after_sale_status)&&(10==l||20==l||40==l||50==l?e.data.packed_items[a].goods_orders[o].after_sale_status="售后处理中":30==l?e.data.packed_items[a].goods_orders[o].after_sale_status="售后完成":60!=l&&70!=l||(e.data.packed_items[a].goods_orders[o].after_sale_status=""))}t.packed_items.push(e.data.packed_items[a])}r=!0;var i={close:"",goods_orders:[]};for(var a in i.close=r,e.data.unpacked_items){var l;null!=(l=e.data.unpacked_items[a].after_sale_status)&&(10==l||20==l||40==l||50==l?e.data.unpacked_items[a].after_sale_status="售后处理中":30==l?e.data.unpacked_items[a].after_sale_status="售后完成":60!=l&&70!=l||(e.data.unpacked_items[a].after_sale_status="")),i.goods_orders.push(e.data.unpacked_items[a])}for(var a in t.info=e.data.shop_order_item.order.receiver,t.address=e.data.shop_order_item.order.receiver.address,e.data.delivery_company)e.data.delivery_company[a].id=1*e.data.delivery_company[a].id,t.options.push(e.data.delivery_company[a]);t.un_packed_items.push(i)})},handleClick:function(e,t){this.closable=e.closable,e.closable?this.path_split=!1:this.path_split=!0,this.name=e.name},delivery:function(e){var t=this;e.delivery_type=this.delivery_type,r.a.delivery(e).then(function(e){t.$message({type:"success",message:"发货成功"}),setTimeout(function(){window.location.reload()},1e3)})},radioChange:function(e){console.log(e)},handleSelectChange:function(e){var t=this;if(t.path=""==e,this.val="",this.val=e,t.formOnSearch.form.package=[],""==e)return!1;e.forEach(function(e){var a={num:"",order_good_no:""};a.num=e.num,a.order_good_no=e.no,t.formOnSearch.form.package.push(a)})},toHandleSelectChange:function(e){var t=this;if(t.path=""==e,this.val="",this.val=e,t.formOnSearch.form.package=[],""==e)return!1;e.forEach(function(e){var a={num:"",order_good_no:""};a.num=e.num,a.order_good_no=e.no,t.formOnSearch.form.package.push(a)})},pathClick:function(){this.pathModlie=!0,this.formOnSearch.form.is_overseas=!0},delPath:function(){this.pathModlie=!1,this.formOnSearch.form.is_overseas=!1,this.formOnSearch.form.overseas_corp_id="",this.formOnSearch.form.overseas_express_no=""},clickDelivery:function(){var e=this;this.handleSelectChange(this.val),20==this.delivery_type?(e.defaultList.forEach(function(t){var a={num:"",order_good_no:""};a.num=t.num,a.order_good_no=t.no,e.formOnSearch.form.package.push(a)}),this.delivery(this.formOnSearch.form)):""==this.formOnSearch.form.package?this.$message({message:"请勾选商品",type:"error",duration:1e3}):this.delivery(this.formOnSearch.form)},addTab:function(e){for(var t in this.un_packed_items[0].goods_orders)this.un_packed_items[0].goods_orders[t].packed_num=this.un_packed_items[0].goods_orders[t].num;this.closable=!0,this.parcel_split=!0,this.path_split=!1;var a=++this.tabIndex+1;this.packed_items.push({title:"包裹"+1*(1*this.packed_items.length+1),name:a,content:this.un_packed_items[0].goods_orders,close:!0}),this.editableTabsValue2=a},removeTab:function(e){this.parcel_split=!1,this.path_split=!0;var t=this.packed_items,a=this.editableTabsValue2;a===e&&t.forEach(function(s,r){if(s.name===e){var o=t[r+1]||t[r-1];o&&(a=o.name)}}),this.editableTabsValue2=a,this.packed_items=t.filter(function(t){return t.name!==e})},clickSubmit:function(){this.post_data=[];var e=this.packed_items;if(this.closable)this.toHandleSelectChange(this.val),this.delivery(this.formOnSearch.form);else{for(var t in e)if(this.name==e[t].name){var a={corp_id:"",express_no:"",is_overseas:!1,overseas_corp_id:"",overseas_express_no:"",order_shop_no:"",package_id:"",package:[]};for(var s in a.corp_id=e[t].deliveries.domestic.corp_id,a.express_no=e[t].deliveries.domestic.express_no,a.order_shop_no=e[t].goods_orders[0].order_shop_no,e[t].deliveries.domestic.package_id?a.package_id=e[t].deliveries.domestic.package_id:a.package_id=0,this.formOnSearch.form.order_shop_no=e[t].goods_orders[0].order_shop_no,e[t].deliveries.overseas&&(a.is_overseas=!0,a.overseas_corp_id=e[t].deliveries.overseas.corp_id,a.overseas_express_no=e[t].deliveries.overseas.express_no),e[t].goods_orders){var r={num:"",order_good_no:""};r.num=e[t].goods_orders[s].packed_num,r.order_good_no=e[t].goods_orders[s].no,a.package.push(r)}}this.delivery(a)}},clickBack:function(){this.$router.push({name:"tradeDeal"})},imageDomains:function(e){var t="",a=e.substring(0,1),s=e.substring(1,a.length);return t+=this.imageDomain+e+s},getShopInfo:function(){var e=this;o.a.getShopInfo().then(function(t){e.isOwn=1===t.data.biz_model})}},components:{VHeader:s.a,TableView:l.a},created:function(){this.initDelivery(Object(i.a)()),this.getShopInfo()}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticStyle:{padding:"10px"}},[a("h2",[e._v("发货商品明细")]),e._v(" "),a("table",{staticStyle:{"border-collapse":"collapse"},attrs:{width:"100%"}},[e._m(0),e._v(" "),e._l(e.defaultList,function(t,s){return a("tr",{key:s},[a("td",{staticClass:"shipMentsImg"},[a("img",{attrs:{src:e.imageDomains(t.primary_image)+"_t.jpg"}}),e._v(" "),a("div",{staticStyle:{display:"inline-block","vertical-align":"top"}},[a("a",{staticClass:"goods_url",attrs:{href:e.defaultUrl("item_id",t),target:"_blank"}},[a("p",[e._v(e._s(t.title))])]),e._v(" "),a("p",[e._v(e._s(t.spec_nature_info))])])]),e._v(" "),a("td",{staticClass:"tc"},[e._v("\n                   "+e._s(t.sell_price)+" \n                ")]),e._v(" "),a("td",{staticClass:"tc"},[e._v("\n                    "+e._s(t.num)+"\n                ")])])})],2),e._v(" "),a("h2",[e._v("发货信息")]),e._v(" "),a("div",[a("p",[e._v("收货人姓名："+e._s(e.address.name))]),e._v(" "),a("p",[e._v("收货手机号："+e._s(e.address.mobile))]),e._v(" "),a("p",[e._v("收货人地址：\n                "+e._s(e.address.state)+"\n                "+e._s(e.address.city)+"\n                "+e._s(e.address.district)+"\n                "+e._s(e.address.address)+"\n            ")])]),e._v(" "),a("h2",[e._v("配送信息")]),e._v(" "),e.isOwn?a("div",{staticClass:"delivery-content"},[a("span",{staticClass:"delivery-head"},[e._v("配送方式:")]),e._v(" "),a("el-radio-group",{attrs:{disabled:0!=e.packed_items.length},on:{change:e.radioChange},model:{value:e.delivery_type,callback:function(t){e.delivery_type=t},expression:"delivery_type"}},[a("el-radio",{attrs:{label:10}},[e._v("快递")]),e._v(" "),a("el-radio",{attrs:{label:20}},[e._v("无需配送")])],1)],1):a("div",{staticClass:"delivery-content"},[a("span",{staticClass:"delivery-head"},[e._v("配送方式:")]),e._v(" "),a("el-radio-group",{attrs:{disabled:0!=e.packed_items.length},on:{change:e.radioChange},model:{value:e.delivery_type,callback:function(t){e.delivery_type=t},expression:"delivery_type"}},[a("el-radio",{attrs:{label:10}},[e._v("快递")])],1)],1),e._v(" "),0==e.packed_items.length?a("div",[10==e.delivery_type?a("table-view",{attrs:{selection:10==e.delivery_type,columns:e.columns,imageDomain:e.imageDomain,pageList:e.list},on:{"select-change":e.handleSelectChange}}):e._e(),e._v(" "),10==e.delivery_type?a("div",{staticStyle:{margin:"20px 0 20px 0"}},[a("el-button",{attrs:{type:"primary",disabled:e.disabled}},[e._v("包裹拆分")]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.path},on:{click:e.pathClick}},[e._v("路径拆分")])],1):e._e(),e._v(" "),a("div",[a("ul",[a("li",[a("el-form",{ref:"formOnSearch",attrs:{model:e.formOnSearch.form,rules:e.rules,"label-width":"100px",size:"medium"}},[10==e.delivery_type?a("el-row",[e.pathModlie?a("el-col",{staticStyle:{position:"relative"},attrs:{span:11,offset:1}},[a("h3",[e._v("国际物流")]),e._v(" "),a("el-form-item",{attrs:{label:"物流公司:"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formOnSearch.form.overseas_corp_id,callback:function(t){e.$set(e.formOnSearch.form,"overseas_corp_id",t)},expression:"formOnSearch.form.overseas_corp_id"}},e._l(e.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"配送单号:"}},[a("el-input",{attrs:{maxlength:"20"},model:{value:e.formOnSearch.form.overseas_express_no,callback:function(t){e.$set(e.formOnSearch.form,"overseas_express_no",t)},expression:"formOnSearch.form.overseas_express_no"}})],1),e._v(" "),a("span",{staticStyle:{position:"absolute",right:"0",top:"0"},on:{click:e.delPath}},[e._v("x")])],1):e._e(),e._v(" "),a("el-col",{attrs:{span:11,offset:1}},[a("h3",[e._v("国内物流")]),e._v(" "),a("el-form-item",{attrs:{label:"物流公司:"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formOnSearch.form.corp_id,callback:function(t){e.$set(e.formOnSearch.form,"corp_id",t)},expression:"formOnSearch.form.corp_id"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"配送单号:"}},[a("el-input",{attrs:{maxlength:"20"},model:{value:e.formOnSearch.form.express_no,callback:function(t){e.$set(e.formOnSearch.form,"express_no",t)},expression:"formOnSearch.form.express_no"}})],1)],1)],1):e._e(),e._v(" "),a("el-row",{staticStyle:{"text-align":"center"}},[a("el-col",{staticClass:"btn-margintop"},[a("el-button",{attrs:{type:"primary"},on:{click:e.clickDelivery}},[e._v("发货")])],1)],1)],1)],1)])])],1):a("div",[10==e.delivery_type?a("div",{staticStyle:{margin:"20px 0 20px 0"}},[a("el-button",{attrs:{type:"primary",disabled:e.parcel_split},on:{click:function(t){return e.addTab(e.editableTabsValue2)}}},[e._v("包裹拆分")]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.path_split},on:{click:e.pathClick}},[e._v("路径拆分")])],1):e._e(),e._v(" "),a("el-tabs",{attrs:{type:"card"},on:{"tab-remove":e.removeTab,"tab-click":e.handleClick},model:{value:e.editableTabsValue2,callback:function(t){e.editableTabsValue2=t},expression:"editableTabsValue2"}},[e._l(e.packed_items,function(t,s){return 10==e.delivery_type?a("el-tab-pane",{key:t.name,attrs:{label:"包裹"+1*(s+1),closable:t.close,name:t.name}},[t.close?a("div",[a("table-view",{attrs:{selection:10==e.delivery_type,columns:e.titles,pageList:t.content,imageDomain:e.imageDomain},on:{"select-change":e.toHandleSelectChange}}),e._v(" "),a("el-form",[a("el-row",[e.pathModlie?a("el-col",{staticStyle:{position:"relative"},attrs:{span:11,offset:1}},[a("h3",[e._v("国际物流")]),e._v(" "),a("el-form-item",{attrs:{label:"物流公司:"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formOnSearch.form.overseas_corp_id,callback:function(t){e.$set(e.formOnSearch.form,"overseas_corp_id",t)},expression:"formOnSearch.form.overseas_corp_id"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"配送单号:"}},[a("el-input",{attrs:{maxlength:"20"},model:{value:e.formOnSearch.form.overseas_express_no,callback:function(t){e.$set(e.formOnSearch.form,"overseas_express_no",t)},expression:"formOnSearch.form.overseas_express_no"}})],1),e._v(" "),a("span",{staticStyle:{position:"absolute",right:"0",top:"0"},on:{click:e.delPath}},[e._v("x")])],1):e._e(),e._v(" "),a("el-col",{attrs:{span:11,offset:1}},[a("h3",[e._v("国内物流")]),e._v(" "),a("el-form-item",{attrs:{label:"物流公司:"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formOnSearch.form.corp_id,callback:function(t){e.$set(e.formOnSearch.form,"corp_id",t)},expression:"formOnSearch.form.corp_id"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"配送单号:"}},[a("el-input",{attrs:{maxlength:"20"},model:{value:e.formOnSearch.form.express_no,callback:function(t){e.$set(e.formOnSearch.form,"express_no",t)},expression:"formOnSearch.form.express_no"}})],1)],1)],1)],1)],1):a("div",[a("table-view",{attrs:{columns:e.title,pageList:t.goods_orders,imageDomain:e.imageDomain}}),e._v(" "),a("el-row",[a("el-col",{attrs:{span:11,offset:1}},[a("h3",[e._v("国内物流")]),e._v(" "),a("label",[e._v("物流公司：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.deliveries.domestic.corp_id,callback:function(a){e.$set(t.deliveries.domestic,"corp_id",a)},expression:"item.deliveries.domestic.corp_id"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("label",[e._v("物流单号：")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.deliveries.domestic.express_no,expression:"item.deliveries.domestic.express_no"}],attrs:{type:"text",maxlength:"20"},domProps:{value:t.deliveries.domestic.express_no},on:{input:function(a){a.target.composing||e.$set(t.deliveries.domestic,"express_no",a.target.value)}}})],1),e._v(" "),t.deliveries.overseas?a("el-col",{attrs:{span:11,offset:1}},[a("h3",[e._v("国际物流")]),e._v(" "),a("label",[e._v("物流公司：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.deliveries.overseas.corp_id,callback:function(a){e.$set(t.deliveries.overseas,"corp_id",a)},expression:"item.deliveries.overseas.corp_id"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("label",[e._v("物流单号：")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.deliveries.overseas.express_no,expression:"item.deliveries.overseas.express_no"}],attrs:{type:"text",maxlength:"20"},domProps:{value:t.deliveries.overseas.express_no},on:{input:function(a){a.target.composing||e.$set(t.deliveries.overseas,"express_no",a.target.value)}}})],1):e._e()],1)],1)]):e._e()}),e._v(" "),a("el-row",{staticClass:"tc"},[10==e.delivery_type?a("el-button",{attrs:{type:"primary"},on:{click:e.clickSubmit}},[e._v("提交")]):a("el-button",{attrs:{type:"primary"},on:{click:e.clickBack}},[e._v("返回")])],1)],2)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("tr",{staticClass:"li"},[t("td",{attrs:{width:"80%"}},[this._v("商品")]),this._v(" "),t("td",{attrs:{width:"10%"}},[this._v("单价")]),this._v(" "),t("td",{attrs:{width:"10%"}},[this._v("数量")])])}]};var _=a("C7Lr")(n,d,!1,function(e){a("SO1B")},null,null);t.default=_.exports},SO1B:function(e,t){}});