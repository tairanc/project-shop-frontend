webpackJsonp([70],{b9k9:function(e,t){},e1Zr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("4YfN"),s=a.n(o),r=a("2bvH"),l=a("1G+u"),i=a("VXZc"),n=a("qsHl"),m=a("NcNL"),c=a.n(m),f=a("wJ7o"),_=a.n(f),d=/^\d+(\.{0,1}\d+){0,1}$/,u={data:function(){var e=this;return{delivery:{form:{freight_template_id:""},dialogVisible:!1},category:{form:{category_id:[]},dialogVisible:!1},formOnSale:{name:"formOnSale",loading:!1,total:0,form:{title:"",art_no:"",shop_category_id:"",shop_category_list:[],supply_bind_status:"",min_price:"",max_price:"",logistics_template_id:"",bar_code:"",status:30,page:1,page_size:20},rules:{title:[{max:60,message:"长度在 0 到 60 个字符",trigger:"blur"}],art_no:[{max:50,message:"长度在 0 到 50 个字符",trigger:"blur"}],min_price:[{validator:function(t,a,o){a?d.test(a)?(e.$refs.formOnSale.validateField("max_price"),o()):o(new Error("最低价必须为数字")):o()},trigger:"blur"}],max_price:[{validator:function(t,a,o){a||0===a?d.test(a)?a<parseFloat(e.formOnSale.form.min_price)?o(new Error("最高价不得小于最低价")):o():o(new Error("最高价必须为数字")):o()},trigger:"blur"}]},columns:[{label:"商品名称",desField:"1"},{label:"店铺分类",field:"shop_category_name",align:"center"},{label:"价格（元）",field:"sell_price",align:"center"},{label:"总库存",field:"total_store",align:"center"},{label:"运费模板",field:"logistics_template_name",align:"center"},{label:"供应链绑定",field:"supply_bind_status",align:"center"},{label:"发布时间",field:"updated_at",align:"center"},{label:"操作",field:"options",link:"/goods-manage/goods/edit",align:"center"}],list:[],selectList:[]},exportList:[]}},computed:s()({},Object(r.c)(["deliveryTplUpList","categoryList"])),methods:{exportGoodTable:function(){var e=this;n.a.exportGoods(this.formOnSale.form).then(function(t){t.data.map(function(e){switch(e.trade_type){case 10:e.trade_type="一般贸易";break;case 20:e.trade_type="海淘";break;case 30:e.trade_type="跨境保税";break;case 40:e.trade_type="海外直邮"}switch(!e.tax_rate&&(e.tax_rate=""),e.status="出售中",e.free_refund){case 0:e.free_refund="否";break;case 1:e.free_refund="是"}}),e.exportList=t.data,setTimeout(function(){var e=_.a.utils.table_to_book(document.querySelector("#export-form"));for(var t in e.Sheets.Sheet1)e.Sheets.Sheet1[t].t&&("("==String(e.Sheets.Sheet1[t].v).substr(0,1)&&""!=e.Sheets.Sheet1[t]&&(e.Sheets.Sheet1[t].v=String(e.Sheets.Sheet1[t].v).substr(1,e.Sheets.Sheet1[t].v.length-1)),e.Sheets.Sheet1[t].t="s");var a=_.a.write(e,{bookType:"xlsx",bookSST:!1,type:"binary"});try{c.a.saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),o=0;o!==e.length;++o)a[o]=255&e.charCodeAt(o);return t}(a)],{type:"application/octet-stream"}),"商品列表.xlsx")}catch(e){"undefined"!=typeof console&&console.log(e,a)}return a},1e3),e.$message({showClose:!0,message:"导出成功",type:"success"})})},getCategoryId:function(e){this.formOnSale.form.shop_category_id=e[e.length-1]},handleSelectChange:function(e){var t=this;t.formOnSale.selectList=[],e.forEach(function(e){t.formOnSale.selectList.push(e.id)})},handleSizeChange:function(e){this.formOnSale.form.page_size=e,this.getItemList(this.formOnSale.form)},handleNumberChange:function(e){this.formOnSale.form.page=e,this.getItemList(this.formOnSale.form)},search:function(){var e=this;this.$refs.formOnSale.validate(function(t){t&&(e.formOnSale.loading=!0,e.formOnSale.form.page=1,e.getItemList(e.formOnSale.form))})},resetForm:function(){this.$refs.formOnSale.resetFields(),this.formOnSale.form.shop_category_list=[]},deleteBtn:function(){var e=this,t={item_ids:this.formOnSale.selectList};this.$confirm("此操作将删除已选择的全部商品, 是否确定?","提示",{closeOnClickModal:!1,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteItemList(t)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},setShelfBtn:function(e){var t=this,a={item_ids:this.formOnSale.selectList,shelf_status:10};this.$confirm("此操作将下架已选择的全部商品, 是否确定?","提示",{closeOnClickModal:!1,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.setShelf(a)}).catch(function(){t.$message({type:"info",message:"已取消下架"})})},setTemplateBtn:function(){var e={item_ids:this.formOnSale.selectList,freight_template_id:this.delivery.form.freight_template_id};this.setTemplate(e)},setCategoryBtn:function(){var e=this.category.form.category_id.length,t={item_ids:this.formOnSale.selectList,category_id:this.category.form.category_id[e-1]};this.setShopCategory(t)},showTemplate:function(){this.delivery.form.freight_template_id="",this.delivery.dialogVisible=!0},cancelTempDialog:function(){this.delivery.dialogVisible=!1,this.$message({type:"info",message:"已取消操作"})},showCategory:function(){this.category.form.category_id=[],this.category.dialogVisible=!0},cancelCategoryDialog:function(){this.category.dialogVisible=!1,this.$message({type:"info",message:"已取消操作"})},getItemList:function(e){var t=this;n.a.getItemList(e).then(function(e){for(var a in t.formOnSale.list=[],t.formOnSale.loading=!1,t.formOnSale.total=e.data.total_count,e.data.list){switch(e.data.list[a].supply_bind_status){case 10:e.data.list[a].supply_bind_status="否";break;case 20:e.data.list[a].supply_bind_status="部分";break;case 30:e.data.list[a].supply_bind_status="是"}e.data.list[a].options={text:"编辑",option:"id"},t.formOnSale.list.push(e.data.list[a])}t.formOnSale.list.sort(function(e,t){return e=new Date(e.updated_at),(t=new Date(t.updated_at))-e})})},deleteItemList:function(e){var t=this;n.a.deleteItemList(e).then(function(e){e.data?(t.$message({type:"success",message:"删除成功！"}),t.search()):t.$message.error(e.message)})},setShelf:function(e){var t=this;n.a.setShelf(e).then(function(e){e.data?(t.$message({type:"success",message:"操作成功！"}),t.search()):t.$message.error(e.message)})},setTemplate:function(e){var t=this;n.a.setTemplate(e).then(function(e){e.data?(t.delivery.dialogVisible=!1,t.$message({type:"success",message:"操作成功！"}),t.search()):t.$message.error(e.message)})},setShopCategory:function(e){var t=this;n.a.setShopCategory(e).then(function(e){e.data?(t.category.dialogVisible=!1,t.$message({type:"success",message:"操作成功！"}),t.search()):t.$message.error(e.message)})}},components:{TableView:l.a,PaginationView:i.a},mounted:function(){this.$route.query&&(this.formOnSale.form.shop_category_id=this.$route.query.category_id),this.search()}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"onSale"},[a("el-form",{ref:"formOnSale",attrs:{model:e.formOnSale.form,rules:e.formOnSale.rules,"label-width":"100px",size:"medium"}},[a("el-row",[a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{label:"商品名称：",prop:"title"}},[a("el-input",{model:{value:e.formOnSale.form.title,callback:function(t){e.$set(e.formOnSale.form,"title",t)},expression:"formOnSale.form.title"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:7,offset:1}},[a("el-form-item",{attrs:{label:"商品货号：",prop:"art_no"}},[a("el-input",{model:{value:e.formOnSale.form.art_no,callback:function(t){e.$set(e.formOnSale.form,"art_no",t)},expression:"formOnSale.form.art_no"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{label:"店铺分类：",prop:"shop_category_id"}},[a("el-cascader",{attrs:{options:e.categoryList},on:{change:e.getCategoryId},model:{value:e.formOnSale.form.shop_category_list,callback:function(t){e.$set(e.formOnSale.form,"shop_category_list",t)},expression:"formOnSale.form.shop_category_list"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{label:"供应链绑定：",prop:"supply_bind_status"}},[a("el-select",{model:{value:e.formOnSale.form.supply_bind_status,callback:function(t){e.$set(e.formOnSale.form,"supply_bind_status",t)},expression:"formOnSale.form.supply_bind_status"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"30"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"10"}}),e._v(" "),a("el-option",{attrs:{label:"部分",value:"20"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:7,offset:1}},[a("el-form-item",{attrs:{label:"销售价格："}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"min_price"}},[a("el-input",{model:{value:e.formOnSale.form.min_price,callback:function(t){e.$set(e.formOnSale.form,"min_price",t)},expression:"formOnSale.form.min_price"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:2}},[e._v("到")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"max_price"}},[a("el-input",{model:{value:e.formOnSale.form.max_price,callback:function(t){e.$set(e.formOnSale.form,"max_price",t)},expression:"formOnSale.form.max_price"}})],1)],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{label:"运费模板：",prop:"logistics_template_id"}},[a("el-select",{model:{value:e.formOnSale.form.logistics_template_id,callback:function(t){e.$set(e.formOnSale.form,"logistics_template_id",t)},expression:"formOnSale.form.logistics_template_id"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.deliveryTplUpList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{label:"条形码：",prop:"bar_code"}},[a("el-input",{model:{value:e.formOnSale.form.bar_code,callback:function(t){e.$set(e.formOnSale.form,"bar_code",t)},expression:"formOnSale.form.bar_code"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6,offset:9}},[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"default"},on:{click:e.resetForm}},[e._v("清空条件")])],1)],1)],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.formOnSale.list.length,expression:"formOnSale.list.length"}],staticClass:"btn-group"},[a("el-button",{attrs:{size:"medium",disabled:!e.formOnSale.selectList.length},on:{click:e.deleteBtn}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{size:"medium",disabled:!e.formOnSale.selectList.length},on:{click:e.setShelfBtn}},[e._v("批量下架")]),e._v(" "),a("el-button",{attrs:{size:"medium",disabled:!e.formOnSale.selectList.length},on:{click:e.showCategory}},[e._v("调整商品分类")]),e._v(" "),a("el-button",{attrs:{size:"medium",disabled:!e.formOnSale.selectList.length},on:{click:e.showTemplate}},[e._v("调整运费模板")]),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:e.exportGoodTable}},[e._v("导出")])],1),e._v(" "),a("div",{staticClass:"table"},[a("table-view",{attrs:{tableName:e.formOnSale.name,selection:!0,loading:e.formOnSale.loading,columns:e.formOnSale.columns,pageList:e.formOnSale.list},on:{"select-change":e.handleSelectChange}})],1),e._v(" "),a("pagination-view",{directives:[{name:"show",rawName:"v-show",value:e.formOnSale.list.length,expression:"formOnSale.list.length"}],attrs:{paginationName:e.formOnSale.name,total:e.formOnSale.total,currentPage:e.formOnSale.form.page},on:{"size-change":e.handleSizeChange,"current-change":e.handleNumberChange}}),e._v(" "),a("table",{attrs:{id:"export-form"}},[e._m(0),e._v(" "),e._l(e.exportList,function(t,o){return a("tr",{key:o},[a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.id))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s("("+t.art_no))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s("("+t.title))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.brand))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s("("+t.barcode))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.store))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.sku_id))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.spec_text))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.sell_price))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.category_primary))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.category_secondary))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.category_third))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.trade_type))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.tax_rate))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.status))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.weight))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.freight_template))]),e._v(" "),a("td",{staticStyle:{"mso-number-format":"'\\@'"}},[e._v(e._s(t.free_refund))])])})],2),e._v(" "),a("el-dialog",{attrs:{title:"选择运费模板",width:"30%",visible:e.delivery.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.delivery,"dialogVisible",t)}}},[a("el-row",[a("el-col",{attrs:{offset:5}},[a("el-form",{attrs:{model:e.delivery.form,size:"medium"}},[a("el-form-item",{attrs:{label:"运费模板："}},[a("el-select",{model:{value:e.delivery.form.freight_template_id,callback:function(t){e.$set(e.delivery.form,"freight_template_id",t)},expression:"delivery.form.freight_template_id"}},e._l(e.deliveryTplUpList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelTempDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.setTemplateBtn}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"调整店铺分类",width:"30%",visible:e.category.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.category,"dialogVisible",t)}}},[a("el-row",[a("el-col",{attrs:{offset:5}},[a("el-form",{attrs:{model:e.category.form,size:"medium"}},[a("el-form-item",{attrs:{label:"店铺分类："}},[a("el-cascader",{attrs:{options:e.categoryList,"show-all-levels":!1},model:{value:e.category.form.category_id,callback:function(t){e.$set(e.category.form,"category_id",t)},expression:"category.form.category_id"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelCategoryDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.setCategoryBtn}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",[a("td",[e._v("商品id")]),e._v(" "),a("td",[e._v("商品货号")]),e._v(" "),a("td",[e._v("商品名称")]),e._v(" "),a("td",[e._v("品牌")]),e._v(" "),a("td",[e._v("条形码")]),e._v(" "),a("td",[e._v("库存")]),e._v(" "),a("td",[e._v("SKU-ID")]),e._v(" "),a("td",[e._v("规格")]),e._v(" "),a("td",[e._v("售价")]),e._v(" "),a("td",[e._v("一级类目")]),e._v(" "),a("td",[e._v("二级类目")]),e._v(" "),a("td",[e._v("三级类目")]),e._v(" "),a("td",[e._v("贸易类型")]),e._v(" "),a("td",[e._v("税率")]),e._v(" "),a("td",[e._v("状态")]),e._v(" "),a("td",[e._v("商品重量(kg)")]),e._v(" "),a("td",[e._v("运费模板")]),e._v(" "),a("td",[e._v("是否支持七天无理由")])])}]};var v=a("C7Lr")(u,p,!1,function(e){a("b9k9")},"data-v-4f1d03b1",null);t.default=v.exports}});