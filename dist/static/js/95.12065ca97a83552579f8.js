webpackJsonp([95],{nj8T:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("VXZc"),l=a("1G+u"),i=a("2AkA"),s=function(e){return Object(i.a)({method:"get",url:"/trmall/settlement/searchPeriodicStatement",params:e})},r=function(e){return Object(i.a)({method:"post",url:"/trmall/settlement/checkPeriodicStatement",data:{ids:e}})},o=function(e){return Object(i.a)({method:"post",url:"/trmall/settlement/exportPeriodicStatement",data:e})},c={data:function(){return{total:0,selectList:[],form:{page:1,page_size:20,settlement_month:"",status:""},list:[],columns:[{label:"创建时间",field:"created_at",align:"center",minWidth:"160px"},{label:"结算周期",field:"settlement_scope_date",align:"center",minWidth:"330px"},{label:"结算方式",field:"zh_periodic",align:"center"},{label:"状态",field:"zh_status",align:"center",minWidth:"100px"},{label:"子订单实付金额",field:"payment",align:"center",minWidth:"120px"},{label:"退款金额",field:"refund_amount",align:"center"},{label:"净销售",field:"sale_amount",align:"center"},{label:"活动e卡金额",field:"activity_e_card_payment",align:"center",minWidth:"100px"},{label:"红包金额",field:"discount_hb",align:"center"},{label:"优惠券平台承担",field:"discount_coupon_platform",align:"center",minWidth:"120px"},{label:"服务费",field:"service_fee",align:"center"},{label:"结算小计",field:"settlement_fee",align:"center"},{label:"商品税费调减",field:"reduce_taxes",align:"center",minWidth:"120px"},{label:"活动e卡调减",field:"reduce_activity_e_card_payment",align:"center",minWidth:"120px"},{label:"红包金额调减",field:"reduce_discount_hb",align:"center",minWidth:"130px"},{label:"优惠券平台承担-调减",field:"reduce_discount_coupon_platform",align:"center",minWidth:"180px"},{label:"服务费调减",field:"reduce_service_fee",align:"center",minWidth:"120px"},{label:"已结算扣回",field:"reduce_settlement_fee",align:"center",minWidth:"120px"},{label:"代付运费",field:"compensatory_freight_amount",align:"center"},{label:"违规罚款",field:"fine_amount",align:"center"},{label:"其他款项",field:"incidental_amount",align:"center"},{label:"结算金额",field:"settlement_total_fee",align:"center"},{label:"商家需开发票",field:"shop_invoice_amount",align:"center",minWidth:"120px"},{label:"平台需开发票",field:"platform_invoice_amount",align:"center",minWidth:"120px"}]}},methods:{searchFormdata:function(e){e.page=1,this.searchPeriodicStatement(e)},searchPeriodicStatement:function(e){var t=this;s(e).then(function(e){for(var a in t.total=e.data.total_count,t.list=[],e.data.list)t.list.push(e.data.list[a])})},sizeChange:function(e){this.form.page_size=e,this.searchPeriodicStatement(this.form)},pageChange:function(e){this.form.page=e,this.searchPeriodicStatement(this.form)},exportExcel:function(){var e=this,t={settlement_month:this.form.settlement_month,status:this.form.status};o(t).then(function(t){t.data.result&&e.$message({message:"导出成功",type:"success"})})},handleSelectChange:function(e){var t=this;t.selectList=[],e.forEach(function(e){t.selectList.push({id:e.id,status:e.status})})},settleConfirm:function(){var e=this;this.selectList.length>=1?this.$confirm("是否确认结算？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.selectList.filter(function(e){return 20==e.status});if(t.length<1)e.$message({type:"info",message:"请选择待确认数据"});else{var a=[];t.map(function(e){a.push(e.id)}),r(a).then(function(t){t.data.result&&e.$message({message:"结算成功",type:"success"}),e.searchPeriodicStatement(e.form)})}}).catch(function(){e.$message({type:"info",message:"已取消结算"})}):this.$message.error("请选择要操作的数据项！")},clearBtn:function(){this.form={settlement_month:"",status:""}}},created:function(){this.searchPeriodicStatement(this.form)},components:{TableView:l.a,PaginationView:n.a}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"summary"},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{label:"账单月：",prop:"start_at"}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM",type:"month",placeholder:"选择月"},model:{value:e.form.settlement_month,callback:function(t){e.$set(e.form,"settlement_month",t)},expression:"form.settlement_month"}})],1)])],1),e._v(" "),a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{label:"状态",prop:"type"}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"待商家确认",value:"20"}}),e._v(" "),a("el-option",{attrs:{label:"商家已确认",value:"30"}}),e._v(" "),a("el-option",{attrs:{label:"平台完成打款",value:"40"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:5,offset:1}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.searchFormdata(e.form)}}},[e._v("搜索")]),e._v(" "),a("el-button",{on:{click:e.clearBtn}},[e._v("清空条件")])],1)],1)],1)],1),e._v(" "),a("p"),e._v(" "),a("div",{staticClass:"btn"},[a("el-row",[a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download",disabled:0==e.list.length},on:{click:e.exportExcel}},[e._v("导出\n        ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.settleConfirm}},[e._v("结算确认")])],1)],1)],1),e._v(" "),a("table-view",{attrs:{height:600,selection:!0,columns:e.columns,pageList:e.list,id:"rebateSetTable"},on:{"select-change":e.handleSelectChange}}),e._v(" "),a("pagination-view",{attrs:{currentPage:e.form.page,total:e.total},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1)},staticRenderFns:[]};var d=a("C7Lr")(c,m,!1,function(e){a("zo7a")},"data-v-13a421a0",null);t.default=d.exports},zo7a:function(e,t){}});